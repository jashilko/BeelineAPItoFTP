# Инструкция по работе  с JSONToFTP

## Что делает программа
1. Подключается к API к личному кабинету билайн-бизнес
2. Получает список файлов разговоров
3. Для каждого разговора
    1. Получает информацию (абонент, направление и т.д) и записывает ее в json-Файл
    2. Скачивает запись разговора
4. Загружает информацию на FTP-сервер

## Первоначальная установка
1. Установить python3 (Минимальная версия 3.6)
2. Установить pip - менеджер пакетов (библиотек питон)
3. Установить git
4. Клонировать репозиторий: git clone https://github.com/jashilko/BeelineAPItoFTP.git
5. Установить зависимости (библиотеки) для работы скрипта из файла requirements.txt: pip install -r requirements.txt
6. Отредактировать файл настроек settings.ini
7. Запустить скрипт python3 JSONToFTP.py

## Файл настроек
Примерный вид: 
```
[General]
limitdownload = 100
logmode = INFO
sleep = 1

[Records]
lastnumber = 1

[BeelineAPI]
jsontoftptoken = *****

[FTP]
host = ftp.localhost.ru
login = xxx
pass = yyy
```
* limitdownload = [положительное число] - максимальное количество пар файлов (json + mp3), которые система обработает за цикл запуска
* logmode = [**INFO**, DEBUG, ERROR] - режим логгирования 
* sleep = [положительное число] - задержка в секундах между загрузками файлов на FTP
* lastnumber = [положительное число] - ИД последней обработанной заявки. При первой работы скрипта установить = 1
* jsontoftptoken = [GUID] - ключ, выданный личным кабинетом билайна
* host, login, pass - хост, логин и пароль для доступа к SFTP

## Обновление скрипта
Если скрипт обновился разработчиком, то его можно обновить следующим образом:
1. Подтянуть последнии изменения git pull
2. Обновить зависимости pip install -r requirements.txt